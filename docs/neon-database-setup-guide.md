# Neon æ•°æ®åº“é…ç½®æŒ‡å—

**æ—¥æœŸï¼š** 2025-12-26  
**é¡¹ç›®ï¼š** fenghua-crm  
**æ•°æ®åº“æœåŠ¡ï¼š** Neon PostgreSQL

---

## ðŸ“Š Epic 1 å®Œæˆç¡®è®¤

âœ… **Epic 1 å·²å®Œæˆï¼** æ‰€æœ‰ Storyï¼ˆ1-1 åˆ° 1-7ï¼‰éƒ½å·²æ ‡è®°ä¸º `done`ã€‚

**Epic 1 æˆæžœï¼š**
- âœ… Twenty CRM åˆå§‹éƒ¨ç½²å’Œé…ç½®
- âœ… ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- âœ… ç”¨æˆ·è´¦æˆ·ç®¡ç†
- âœ… è§’è‰²ç®¡ç†ç³»ç»Ÿ
- âœ… ç³»ç»Ÿè®¾ç½®ç®¡ç†
- âœ… ç³»ç»Ÿç›‘æŽ§å’Œæ—¥å¿—æŸ¥çœ‹
- âœ… æ•°æ®å¤‡ä»½å’Œæ¢å¤

---

## ðŸŽ¯ æ•°æ®åº“é…ç½®æ—¶æœº

**å»ºè®®ï¼š** åœ¨å¼€å§‹ Epic 2ï¼ˆäº§å“ç®¡ç†ï¼‰ä¹‹å‰å®Œæˆæ•°æ®åº“é…ç½®ã€‚

**ç†ç”±ï¼š**
1. Epic 2 éœ€è¦åˆ›å»ºäº§å“è¡¨ï¼ˆ`products`ï¼‰
2. éœ€è¦å»ºç«‹ä¸Ž Twenty CRM çš„æ•°æ®å…³è”
3. æå‰é…ç½®å¯ä»¥é¿å…å¼€å‘è¿‡ç¨‹ä¸­çš„æ•°æ®è¿ç§»é—®é¢˜

---

## ðŸ—„ï¸ Neon æ•°æ®åº“æ–¹æ¡ˆè¯„ä¼°

### å½“å‰æž¶æž„çŠ¶æ€

æ ¹æ®åŸºç¡€è®¾æ–½å†³ç­–æ–‡æ¡£ï¼Œå½“å‰æŽ¨è**æ–¹æ¡ˆ Aï¼šå…±äº«æ•°æ®åº“**ï¼ˆä½¿ç”¨ Twenty CRM çš„ PostgreSQLï¼‰ã€‚

### ä½¿ç”¨ Neon çš„ä¸¤ç§æ–¹æ¡ˆ

#### æ–¹æ¡ˆ 1ï¼šå®Œå…¨è¿ç§»åˆ° Neonï¼ˆæŽ¨èç”¨äºŽæ–°é¡¹ç›®ï¼‰

**æž¶æž„ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Neon PostgreSQL               â”‚
â”‚                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ Twenty CRM æ•°æ®         â”‚  â”‚
â”‚   â”‚ - Companies (å®¢æˆ·)      â”‚  â”‚
â”‚   â”‚ - Contacts (è”ç³»äºº)     â”‚  â”‚
â”‚   â”‚ - Users (ç”¨æˆ·)          â”‚  â”‚
â”‚   â”‚ - WorkspaceMembers      â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                 â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ fenghua-crm å®šåˆ¶è¡¨      â”‚  â”‚
â”‚   â”‚ - products (äº§å“)        â”‚  â”‚
â”‚   â”‚ - interactions (äº’åŠ¨è®°å½•)â”‚  â”‚
â”‚   â”‚ - file_attachments       â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜ç‚¹ï¼š**
- âœ… ç»Ÿä¸€ç®¡ç†ï¼Œæ˜“äºŽå¤‡ä»½å’Œæ¢å¤
- âœ… æ•°æ®å…³è”æ–¹ä¾¿ï¼ˆå¯ä»¥ç›´æŽ¥ JOINï¼‰
- âœ… äº‹åŠ¡å¤„ç†ç®€å•ï¼ˆåŒä¸€äº‹åŠ¡ï¼‰
- âœ… æ€§èƒ½å¥½ï¼ˆæ•°æ®åº“æŸ¥è¯¢ï¼Œæ— ç½‘ç»œå»¶è¿Ÿï¼‰
- âœ… Neon æä¾›è‡ªåŠ¨å¤‡ä»½å’Œåˆ†æ”¯åŠŸèƒ½

**ç¼ºç‚¹ï¼š**
- âš ï¸ éœ€è¦è¿ç§» Twenty CRM æ•°æ®åˆ° Neon
- âš ï¸ éœ€è¦é…ç½® Twenty CRM ä½¿ç”¨ Neon æ•°æ®åº“

**å®žæ–½æ­¥éª¤ï¼š**
1. åœ¨ Neon åˆ›å»ºæ–°é¡¹ç›®æˆ–ä½¿ç”¨çŽ°æœ‰é¡¹ç›®
2. è¿ç§» Twenty CRM æ•°æ®åˆ° Neon
3. é…ç½® Twenty CRM è¿žæŽ¥å­—ç¬¦ä¸²æŒ‡å‘ Neon
4. åœ¨ Neon æ•°æ®åº“ä¸­åˆ›å»º fenghua-crm å®šåˆ¶è¡¨

---

#### æ–¹æ¡ˆ 2ï¼šç‹¬ç«‹æ•°æ®åº“ï¼ˆNeon ä»…ç”¨äºŽå®šåˆ¶è¡¨ï¼‰

**æž¶æž„ï¼š**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Twenty PostgreSQL   â”‚         â”‚ Neon PostgreSQL     â”‚
â”‚ (æœ¬åœ°/Docker)        â”‚         â”‚ (fenghua-crm å®šåˆ¶)   â”‚
â”‚                     â”‚         â”‚                     â”‚
â”‚ - Companies         â”‚         â”‚ - products          â”‚
â”‚ - Contacts          â”‚         â”‚ - interactions      â”‚
â”‚ - Users             â”‚         â”‚ - file_attachments  â”‚
â”‚ - WorkspaceMembers  â”‚         â”‚                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚                               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**ä¼˜ç‚¹ï¼š**
- âœ… å®Œå…¨éš”ç¦»ï¼Œä¸å— Twenty CRM æ•°æ®åº“å˜æ›´å½±å“
- âœ… æ˜“äºŽå¤‡ä»½å’Œæ¢å¤ï¼ˆNeon è‡ªåŠ¨å¤‡ä»½ï¼‰
- âœ… å¯ä»¥ç‹¬ç«‹å‡çº§
- âœ… Neon æä¾›åˆ†æ”¯åŠŸèƒ½ï¼Œä¾¿äºŽå¼€å‘æµ‹è¯•

**ç¼ºç‚¹ï¼š**
- âŒ æ•°æ®å…³è”å¤æ‚ï¼ˆéœ€è¦é€šè¿‡ APIï¼‰
- âŒ æ— æ³•ä½¿ç”¨æ•°æ®åº“ JOIN
- âŒ äº‹åŠ¡å¤„ç†å¤æ‚ï¼ˆéœ€è¦è¡¥å¿äº‹åŠ¡/Saga æ¨¡å¼ï¼‰
- âŒ æ€§èƒ½å½±å“ï¼ˆAPI è°ƒç”¨ vs æ•°æ®åº“æŸ¥è¯¢ï¼‰

**å®žæ–½æ­¥éª¤ï¼š**
1. åœ¨ Neon åˆ›å»ºæ–°é¡¹ç›®æˆ–ä½¿ç”¨çŽ°æœ‰é¡¹ç›®
2. åœ¨ Neon æ•°æ®åº“ä¸­åˆ›å»º fenghua-crm å®šåˆ¶è¡¨
3. é…ç½® `fenghua-backend` ä½¿ç”¨ Neon æ•°æ®åº“è¿žæŽ¥
4. å®žçŽ°æ•°æ®å…³è”é€»è¾‘ï¼ˆé€šè¿‡ Twenty CRM APIï¼‰

---

## ðŸš€ æŽ¨èæ–¹æ¡ˆ

**å»ºè®®ï¼šæ–¹æ¡ˆ 1ï¼ˆå®Œå…¨è¿ç§»åˆ° Neonï¼‰**

**ç†ç”±ï¼š**
1. **Epic 2 éœ€è¦é¢‘ç¹å…³è”äº§å“ä¸Žå®¢æˆ·æ•°æ®**ï¼Œå…±äº«æ•°æ®åº“å¯ä»¥æ–¹ä¾¿åœ°ä½¿ç”¨ JOIN æŸ¥è¯¢
2. **Neon æä¾›è‡ªåŠ¨å¤‡ä»½å’Œåˆ†æ”¯åŠŸèƒ½**ï¼Œéžå¸¸é€‚åˆå¼€å‘å’Œç”Ÿäº§çŽ¯å¢ƒ
3. **ç»Ÿä¸€ç®¡ç†**ï¼Œå‡å°‘è¿ç»´å¤æ‚åº¦
4. **æ€§èƒ½ä¼˜åŠ¿**ï¼Œæ•°æ®åº“æŸ¥è¯¢æ¯” API è°ƒç”¨å¿«å¾—å¤š

**å¦‚æžœé€‰æ‹©æ–¹æ¡ˆ 1ï¼Œéœ€è¦ï¼š**
- è¿ç§» Twenty CRM æ•°æ®åˆ° Neonï¼ˆå¯ä»¥ä½¿ç”¨ `pg_dump` å’Œ `pg_restore`ï¼‰
- æ›´æ–° Twenty CRM çš„ `DATABASE_URL` çŽ¯å¢ƒå˜é‡
- åœ¨ Neon æ•°æ®åº“ä¸­åˆ›å»º fenghua-crm å®šåˆ¶è¡¨

---

## ðŸ“‹ Neon æ•°æ®åº“é…ç½®æ­¥éª¤

### æ­¥éª¤ 1ï¼šåˆ›å»º Neon é¡¹ç›®ï¼ˆå¦‚æžœè¿˜æ²¡æœ‰ï¼‰

æ‚¨å·²ç»æœ‰ä¸€ä¸ª Neon é¡¹ç›®ï¼š`travis-blog` (ID: `patient-waterfall-28403372`)

**é€‰é¡¹ï¼š**
- **é€‰é¡¹ Aï¼š** ä½¿ç”¨çŽ°æœ‰é¡¹ç›®ï¼ˆå¦‚æžœ `travis-blog` å¯ä»¥ç”¨äºŽ fenghua-crmï¼‰
- **é€‰é¡¹ Bï¼š** åˆ›å»ºæ–°é¡¹ç›®ä¸“é—¨ç”¨äºŽ fenghua-crm

**å»ºè®®ï¼š** åˆ›å»ºæ–°é¡¹ç›® `fenghua-crm` ä»¥ä¿æŒæ•°æ®éš”ç¦»ã€‚

### æ­¥éª¤ 2ï¼šèŽ·å–è¿žæŽ¥å­—ç¬¦ä¸²

æ‚¨çš„ Neon é¡¹ç›®è¿žæŽ¥å­—ç¬¦ä¸²ï¼š
```
postgresql://neondb_owner:npg_80eZixCVrRAy@ep-winter-pine-ahlj2mzz-pooler.c-3.us-east-1.aws.neon.tech/neondb?channel_binding=require&sslmode=require
```

**æ³¨æ„ï¼š** è¿™æ˜¯çŽ°æœ‰é¡¹ç›®çš„è¿žæŽ¥å­—ç¬¦ä¸²ã€‚å¦‚æžœåˆ›å»ºæ–°é¡¹ç›®ï¼Œä¼šå¾—åˆ°æ–°çš„è¿žæŽ¥å­—ç¬¦ä¸²ã€‚

### æ­¥éª¤ 3ï¼šåˆ›å»ºæ•°æ®åº“åˆ†æ”¯ï¼ˆç”¨äºŽå¼€å‘ï¼‰

Neon æ”¯æŒåˆ†æ”¯åŠŸèƒ½ï¼Œå¯ä»¥åˆ›å»ºå¼€å‘åˆ†æ”¯ç”¨äºŽæµ‹è¯•ã€‚

### æ­¥éª¤ 4ï¼šè¿è¡Œæ•°æ®åº“è¿ç§»

åœ¨ Neon æ•°æ®åº“ä¸­è¿è¡Œ fenghua-crm çš„è¿ç§»è„šæœ¬ï¼š
- `001-create-products-table.sql`
- `002-create-interactions-table.sql`ï¼ˆEpic 4 éœ€è¦ï¼‰
- `003-create-attachments-table.sql`ï¼ˆEpic 4 éœ€è¦ï¼‰

---

## ðŸ”§ å®žæ–½å»ºè®®

### å¦‚æžœé€‰æ‹©æ–¹æ¡ˆ 1ï¼ˆå®Œå…¨è¿ç§»åˆ° Neonï¼‰

1. **åˆ›å»ºæ–°çš„ Neon é¡¹ç›®**ï¼ˆæˆ–ä½¿ç”¨çŽ°æœ‰é¡¹ç›®ï¼‰
2. **è¿ç§» Twenty CRM æ•°æ®**ï¼š
   ```bash
   # ä»Žå½“å‰ Twenty CRM æ•°æ®åº“å¯¼å‡º
   pg_dump -h localhost -U postgres -d twenty_dev > twenty_backup.sql
   
   # å¯¼å…¥åˆ° Neon
   psql "postgresql://neondb_owner:password@ep-xxx.neon.tech/neondb" < twenty_backup.sql
   ```
3. **æ›´æ–° Twenty CRM çŽ¯å¢ƒå˜é‡**ï¼š
   ```env
   DATABASE_URL="postgresql://neondb_owner:password@ep-xxx.neon.tech/neondb"
   ```
4. **è¿è¡Œ fenghua-crm è¿ç§»è„šæœ¬**åœ¨ Neon æ•°æ®åº“ä¸­

### å¦‚æžœé€‰æ‹©æ–¹æ¡ˆ 2ï¼ˆç‹¬ç«‹æ•°æ®åº“ï¼‰

1. **åˆ›å»ºæ–°çš„ Neon é¡¹ç›®**ï¼ˆæˆ–ä½¿ç”¨çŽ°æœ‰é¡¹ç›®ï¼‰
2. **è¿è¡Œ fenghua-crm è¿ç§»è„šæœ¬**åœ¨ Neon æ•°æ®åº“ä¸­
3. **é…ç½® fenghua-backend ä½¿ç”¨ Neon**ï¼š
   ```env
   # fenghua-backend/.env
   DATABASE_URL="postgresql://neondb_owner:password@ep-xxx.neon.tech/neondb"
   # æˆ–ä½¿ç”¨å•ç‹¬çš„å˜é‡
   FENGHUA_DATABASE_URL="postgresql://neondb_owner:password@ep-xxx.neon.tech/neondb"
   ```
4. **æ›´æ–°ä»£ç **ä»¥ä½¿ç”¨ç‹¬ç«‹æ•°æ®åº“è¿žæŽ¥

---

## â“ éœ€è¦å†³ç­–çš„é—®é¢˜

1. **ä½¿ç”¨çŽ°æœ‰ Neon é¡¹ç›®è¿˜æ˜¯åˆ›å»ºæ–°é¡¹ç›®ï¼Ÿ**
   - çŽ°æœ‰é¡¹ç›®ï¼š`travis-blog`ï¼ˆå¯èƒ½ç”¨äºŽå…¶ä»–ç”¨é€”ï¼‰
   - å»ºè®®ï¼šåˆ›å»ºæ–°é¡¹ç›® `fenghua-crm` ä»¥ä¿æŒæ•°æ®éš”ç¦»

2. **é€‰æ‹©æ–¹æ¡ˆ 1 è¿˜æ˜¯æ–¹æ¡ˆ 2ï¼Ÿ**
   - æ–¹æ¡ˆ 1ï¼šå®Œå…¨è¿ç§»åˆ° Neonï¼ˆæŽ¨èï¼Œæ€§èƒ½å¥½ï¼Œå¼€å‘ç®€å•ï¼‰
   - æ–¹æ¡ˆ 2ï¼šç‹¬ç«‹æ•°æ®åº“ï¼ˆå®Œå…¨éš”ç¦»ï¼Œä½†éœ€è¦æ›´å¤šå¼€å‘å·¥ä½œï¼‰

3. **ä½•æ—¶å¼€å§‹è¿ç§»ï¼Ÿ**
   - å»ºè®®ï¼šçŽ°åœ¨å¼€å§‹ï¼Œåœ¨ Epic 2 å¼€å‘å‰å®Œæˆ

---

## ðŸ“ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

è¯·å‘Šè¯‰æˆ‘æ‚¨çš„é€‰æ‹©ï¼š
1. **åˆ›å»ºæ–°çš„ Neon é¡¹ç›®**è¿˜æ˜¯ä½¿ç”¨çŽ°æœ‰é¡¹ç›®ï¼Ÿ
2. **é€‰æ‹©æ–¹æ¡ˆ 1ï¼ˆå®Œå…¨è¿ç§»ï¼‰**è¿˜æ˜¯æ–¹æ¡ˆ 2ï¼ˆç‹¬ç«‹æ•°æ®åº“ï¼‰ï¼Ÿ
3. **æ˜¯å¦éœ€è¦æˆ‘å¸®æ‚¨åˆ›å»º Neon é¡¹ç›®å¹¶è¿è¡Œè¿ç§»è„šæœ¬ï¼Ÿ**

---

**å‚è€ƒæ–‡æ¡£ï¼š**
- [åŸºç¡€è®¾æ–½å†³ç­–æ–‡æ¡£](infrastructure-decisions.md)
- [æ•°æ®åº“è¡¨ç»“æž„è®¾è®¡](database-schema-design.md)
- [Neon å®˜æ–¹æ–‡æ¡£](https://neon.tech/docs)

