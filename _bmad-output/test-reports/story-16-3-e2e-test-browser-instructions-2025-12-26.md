# Story 16.3 浏览器端到端测试指南

**Story:** 16.3 - 替换用户和角色管理  
**创建日期：** 2025-12-26

---

## 🚀 快速开始

### 步骤 1: 打开浏览器并登录

1. **打开浏览器：**
   - 访问：`http://localhost:3005/login`

2. **登录系统：**
   - 邮箱：你的管理员邮箱
   - 密码：你的密码
   - 点击"登录"

3. **获取 Token（用于 API 测试）：**
   - 按 F12 打开开发者工具
   - 进入 **Application** > **Local Storage** > `http://localhost:3005`
   - 找到 `fenghua_auth_token`，复制其值
   - 在终端中设置：`export TEST_TOKEN='your-token-here'`

---

## 📋 测试步骤

### 测试 1: 查看用户列表

1. **导航到用户管理页面：**
   - 点击导航菜单中的"用户管理"
   - 或直接访问：`http://localhost:3005/users`

2. **验证用户列表：**
   - ✅ 检查是否显示所有用户
   - ✅ 检查每个用户的信息：
     - 邮箱
     - 姓名（first_name + last_name）
     - 角色（应该显示角色名称）
     - 创建时间
   - ✅ 检查 null 角色处理（应该显示"无角色"或类似提示）

**预期结果：**
- 用户列表正确显示
- 所有用户信息完整
- 角色信息正确显示

---

### 测试 2: 创建新用户

1. **点击"创建新用户"按钮**

2. **填写表单：**
   - 邮箱：`test-user-$(date +%s)@example.com`（使用时间戳确保唯一）
   - 密码：`test123456`
   - 姓名：`测试` `用户`
   - 角色：选择 `FRONTEND_SPECIALIST`（前端专员）

3. **提交表单**

4. **验证结果：**
   - ✅ 显示成功消息
   - ✅ 用户出现在用户列表中
   - ✅ 用户信息正确
   - ✅ 角色正确显示

**预期结果：**
- 用户创建成功
- 用户信息正确
- 角色正确分配

---

### 测试 3: 更新用户信息

1. **选择用户：**
   - 在用户列表中找到刚才创建的用户
   - 点击"编辑"按钮

2. **修改信息：**
   - 修改姓名：`更新` `用户`
   - 修改角色：改为 `ADMIN`（管理员）

3. **保存更改**

4. **验证结果：**
   - ✅ 显示成功消息
   - ✅ 用户列表中的信息已更新
   - ✅ 角色已更新

**预期结果：**
- 用户信息更新成功
- 角色更新成功

---

### 测试 4: 软删除用户

1. **选择用户：**
   - 选择一个用户（不是当前登录的用户）
   - 点击"删除"按钮

2. **确认删除**

3. **验证结果：**
   - ✅ 用户从列表中消失
   - ✅ 显示成功消息

**预期结果：**
- 用户被软删除
- 用户从列表中消失

---

### 测试 5: 测试自我删除保护

1. **尝试删除自己：**
   - 尝试删除当前登录的用户
   - 点击"删除"按钮

2. **验证保护机制：**
   - ✅ 显示错误消息："不能删除自己的账户"
   - ✅ 用户未被删除

**预期结果：**
- 错误消息正确
- 用户未被删除

---

## 🔍 调试技巧

### 浏览器开发者工具

1. **Network 标签页：**
   - 查看所有 API 请求
   - 检查请求和响应
   - 查看错误状态码

2. **Console 标签页：**
   - 查看 JavaScript 错误
   - 查看日志输出

3. **Application > Local Storage：**
   - 检查 `fenghua_auth_token` 是否存在
   - 检查 token 值

---

## 📝 测试记录

执行测试后，请记录：

1. **测试时间：** [时间]
2. **测试环境：** [环境信息]
3. **测试结果：** [通过/失败]
4. **发现的问题：** [问题描述]
5. **截图/日志：** [附件路径]

---

**创建时间：** 2025-12-26

