# Story 0-8 回归测试执行指南

**创建日期：** 2026-01-12  
**Story：** 0-8-epic-1-2-regression-testing  
**用途：** 指导手动回归测试的执行

---

## 🚀 快速开始

### 1. 启动测试环境

```bash
# 启动前端应用
cd fenghua-frontend
npm run dev

# 确认应用运行在 http://localhost:3005
```

### 2. 准备测试账号

- **管理员账号：** 需要可以访问所有功能
- **普通用户账号：** 用于权限控制测试

### 3. 打开测试工具

- Chrome 浏览器
- Chrome DevTools（F12）
  - Network 标签页（用于验证自动刷新）
  - Memory 标签页（用于检查内存泄漏）
  - Responsive Design Mode（用于响应式测试）

---

## 📋 测试执行流程

### 阶段 1：基础功能测试（优先级最高）

#### Story 1-1: 首页导航和登出

**测试时间：** 15 分钟

**功能测试：**
1. **首页导航功能：**
   - 访问首页 `http://localhost:3005/`
   - 点击各个导航链接（产品管理、客户管理、互动记录等）
   - 验证：所有导航链接可点击并正确跳转

2. **登出功能：**
   - 点击登出按钮
   - 验证：跳转到登录页面，localStorage 中的 token 被清除

3. **权限控制：**
   - 使用非管理员账号登录
   - 访问首页
   - 验证：非管理员用户看不到管理员功能

**视觉测试：**
- 检查页面是否使用设计 Token（`bg-linear-dark-alt`, `text-linear-text`）
- 检查是否使用 Card 和 Button 组件
- 检查深色模式显示是否正常

**响应式测试：**
- 移动端（375px）：导航链接是否换行
- 平板（768px）：布局是否正常
- 桌面（1920px）：布局是否正常

**可访问性测试：**
- Tab 键导航：所有链接和按钮是否可以通过 Tab 键访问
- ARIA 属性：检查必要的 ARIA 属性

---

#### Story 1-2: 用户认证系统

**测试时间：** 20 分钟

**功能测试：**
1. **登录功能：**
   - 输入正确的用户名和密码
   - 点击登录按钮
   - 验证：登录成功，跳转到首页，token 保存到 localStorage

2. **错误提示：**
   - 输入错误的用户名或密码
   - 点击登录按钮
   - 验证：显示错误消息，错误消息使用 `role="alert"`

3. **密码显示/隐藏：**
   - 点击密码输入框右侧的眼睛图标
   - 验证：密码在显示和隐藏之间切换

4. **路由重定向：**
   - 登录成功后观察页面跳转
   - 验证：自动跳转到首页

5. **加载状态：**
   - 点击登录按钮后观察按钮状态
   - 验证：按钮显示加载状态，按钮禁用

**视觉测试：**
- 检查是否使用 Card、Input、Button 组件
- 检查渐变背景动画是否正常
- 检查深色模式显示是否正常

**响应式测试：**
- 移动端、平板、桌面：表单布局是否正常

**可访问性测试：**
- 表单标签关联：每个 input 都有对应的 label
- 错误消息可访问性：错误消息有 `role="alert"` 属性
- 密码显示/隐藏按钮：可以通过 Tab 键访问，可以通过 Enter 键激活

---

### 阶段 2：核心功能测试

#### Story 1-3: 用户账户管理

**测试时间：** 30 分钟

**功能测试：**
1. **用户列表显示：**
   - 访问用户管理页面
   - 验证：用户列表正确显示，包含用户名、邮箱、角色等信息

2. **创建用户：**
   - 点击"创建用户"按钮
   - 填写表单（用户名、邮箱、密码、角色）
   - 点击提交
   - 验证：用户创建成功，显示成功消息，新用户出现在列表中

3. **编辑用户：**
   - 点击"编辑"按钮
   - 修改用户信息（如邮箱、角色）
   - 点击提交
   - 验证：用户更新成功，密码字段可选（编辑时不需要密码）

4. **删除用户：**
   - 点击"删除"按钮
   - 确认删除
   - 验证：用户删除成功，用户从列表中移除

5. **表单验证：**
   - 尝试提交表单，但必填字段为空或密码不符合要求
   - 验证：显示验证错误消息，表单阻止提交

**视觉测试：**
- 检查是否使用 Table、Input、Button、Card 组件
- 检查深色模式显示是否正常

**响应式测试：**
- 移动端：表格是否横向滚动（`overflow-x-auto`）
- 所有屏幕尺寸：表单布局是否正常

**可访问性测试：**
- 表格可访问性：表格有 `aria-label` 属性
- 表单标签关联：每个 input 都有对应的 label
- 错误消息可访问性：错误消息有 `role="alert"` 属性

---

#### Story 1-4: 角色管理系统

**测试时间：** 15 分钟

**功能测试：**
1. **角色选择：**
   - 在用户创建/编辑表单中选择角色
   - 验证：角色选择成功，角色值正确保存

2. **角色描述显示：**
   - 选择角色后观察角色描述
   - 验证：角色描述正确显示

3. **表单验证：**
   - 尝试提交表单，但角色字段为空
   - 验证：显示验证错误消息，表单阻止提交

**视觉测试：**
- 检查角色选择框是否使用设计 Token
- 检查是否使用 Input 和 Button 组件
- 检查深色模式显示是否正常

**响应式测试：**
- 所有屏幕尺寸：表单布局是否正常

**可访问性测试：**
- 表单标签关联：select 有对应的 label
- 下拉选择框可访问性：可以通过 Tab 键访问，可以通过键盘选择选项

---

#### Story 2-1: 产品创建和管理

**测试时间：** 30 分钟

**功能测试：**
1. **产品列表显示：**
   - 访问产品管理页面
   - 验证：产品列表正确显示

2. **产品创建：**
   - 点击"创建产品"按钮
   - 填写表单
   - 点击提交
   - 验证：产品创建成功，显示成功消息

3. **产品编辑：**
   - 点击"编辑"按钮
   - 修改产品信息
   - 点击提交
   - 验证：产品更新成功

4. **产品删除：**
   - 点击"删除"按钮
   - 确认删除（确认对话框）
   - 验证：产品删除成功

5. **产品筛选：**
   - 使用筛选功能
   - 验证：筛选结果正确

6. **产品分页：**
   - 测试分页功能
   - 验证：分页正常工作

**视觉测试：**
- 检查是否使用 Table、Input、Button、Card 组件
- 检查确认对话框是否使用 Card 和 Button 组件（替换了 window.confirm）
- 检查深色模式显示是否正常

**响应式测试：**
- 移动端：表格是否横向滚动
- 所有屏幕尺寸：表单布局是否正常

**可访问性测试：**
- 表格可访问性：表格有 `aria-label` 属性
- 表单标签关联：每个 input 都有对应的 label
- 错误消息可访问性：错误消息有 `role="alert"` 属性
- 确认对话框可访问性：对话框可以通过键盘操作

---

### 阶段 3：管理功能测试

#### Story 1-5: 系统设置管理

**测试时间：** 20 分钟

**功能测试：**
1. **系统设置加载：**
   - 访问系统设置页面
   - 验证：设置数据正确加载并显示在表单中

2. **系统设置编辑：**
   - 修改设置值（如数据保留天数）
   - 点击保存按钮
   - 验证：设置成功保存，显示成功消息"系统设置已更新"

3. **错误处理：**
   - 模拟保存失败（网络错误）
   - 验证：错误消息正确显示，使用 `role="alert"`

4. **表单验证：**
   - 输入无效值（如负数）
   - 验证：显示验证错误消息

5. **重试功能：**
   - 在加载失败时点击重试按钮
   - 验证：重新加载设置数据

**视觉测试：**
- 检查是否使用 Card、Input、Button 组件
- 检查深色模式显示是否正常

**响应式测试：**
- 所有屏幕尺寸：表单布局是否正常

**可访问性测试：**
- 表单标签关联：每个 input 都有对应的 label
- 错误消息可访问性：错误消息有 `role="alert"` 属性

---

#### Story 1-6: 系统监控和日志

**测试时间：** 25 分钟

**功能测试：**
1. **系统健康状态显示：**
   - 访问系统监控页面
   - 验证：系统健康状态正确显示（数据库状态、Redis 状态等）

2. **自动刷新功能：**
   - 访问系统监控页面
   - 打开 Chrome DevTools → Network 标签页
   - 等待 30 秒
   - 验证：页面每 30 秒自动刷新健康状态（Network 标签页显示新的请求）

3. **刷新中断测试：**
   - 访问系统监控页面
   - 打开 Chrome DevTools → Memory 标签页
   - 等待多次刷新
   - 验证：没有内存泄漏（Memory 标签页显示内存使用稳定）

4. **错误处理：**
   - 模拟 API 错误
   - 验证：错误消息正确显示

**视觉测试：**
- 检查是否使用 Card 组件
- 检查深色模式显示是否正常

**响应式测试：**
- 所有屏幕尺寸：布局是否正常

**可访问性测试：**
- 错误消息可访问性：错误消息有 `role="alert"` 属性
- 状态信息可访问性：状态信息清晰可读

---

#### Story 1-7: 数据备份和恢复

**测试时间：** 40 分钟

**功能测试：**
1. **系统日志查看：**
   - 访问系统日志页面
   - 验证：日志列表正确显示

2. **日志筛选和分页：**
   - 使用筛选功能
   - 测试分页功能
   - 验证：筛选和分页正常工作

3. **错误日志查看：**
   - 访问错误日志页面
   - 验证：错误日志正确显示

4. **错误日志堆栈显示：**
   - 点击错误日志查看详情
   - 验证：堆栈信息正确显示

5. **审计日志查看：**
   - 访问审计日志页面
   - 验证：审计日志正确显示

6. **备份状态查看：**
   - 访问备份状态页面
   - 验证：备份状态正确显示

7. **备份自动刷新：**
   - 访问备份状态页面
   - 打开 Chrome DevTools → Network 标签页
   - 等待自动刷新
   - 验证：自动刷新正常工作

8. **数据恢复操作：**
   - 执行数据恢复操作
   - 验证：恢复操作正常执行

9. **恢复状态轮询：**
   - 执行数据恢复操作
   - 打开 Chrome DevTools → Network 标签页
   - 观察状态轮询
   - 验证：状态轮询正常工作

**视觉测试：**
- 检查是否使用 Card、Table、Button、Input 组件
- 检查深色模式显示是否正常

**响应式测试：**
- 移动端：表格是否横向滚动
- 所有屏幕尺寸：筛选表单布局是否正常

**可访问性测试：**
- 表格可访问性：表格有 `aria-label` 属性
- 表单标签关联：每个 input 都有对应的 label
- 错误消息可访问性：错误消息有 `role="alert"` 属性

---

## 📝 测试记录

### 记录格式

每完成一个测试用例，记录：

```markdown
#### [Story ID] [功能名称] 测试

**测试时间：** 2026-01-12 14:30
**测试人：** [姓名]
**测试环境：** Chrome 120 / Windows 11

**测试步骤：**
1. [步骤 1]
2. [步骤 2]

**预期结果：**
- [预期 1]
- [预期 2]

**实际结果：**
- [实际 1]
- [实际 2]

**测试结果：** ✅ 通过 / ❌ 失败 / ⚠️ 部分通过

**问题记录：**
- [问题描述]（如果有）
```

### 问题分类

- **Critical：** 阻塞功能，必须立即修复
- **High：** 重要功能问题，应尽快修复
- **Medium：** 次要功能问题，可以稍后修复
- **Low：** 优化建议，可以记录为技术债务

---

## 🎯 测试完成标准

### 完成条件

- ✅ 所有功能测试通过
- ✅ 所有视觉测试通过
- ✅ 所有响应式测试通过
- ✅ 所有可访问性测试通过
- ✅ 所有发现的问题已记录
- ✅ 所有 Critical 和 High 问题已修复或记录为已知问题

### 测试报告

完成所有测试后，更新测试报告：
- `_bmad-output/test-reports/regression-test-story-0-8-2025-12-26.md`

---

**指南创建时间：** 2026-01-12
