# Story 6-7 关键测试计划

**Story:** 6-7-search-results-filtering - 搜索结果筛选  
**测试日期:** 2025-01-08  
**测试范围:** 关键功能测试（多条件组合筛选、筛选清除功能）

---

## 测试目标

验证 Story 6-7 的核心功能：
1. **多条件组合筛选** - 验证多个筛选条件可以正确组合（AND 逻辑）
2. **筛选清除功能** - 验证单个清除和全部清除功能正常工作

---

## 测试环境准备

### 前置条件
1. 后端服务运行在 `http://localhost:3001`
2. 前端服务运行在 `http://localhost:5173`
3. 数据库中有足够的测试数据：
   - 至少 2 个客户（1 个采购商，1 个供应商）
   - 至少 2 个产品（不同类别）
   - 至少 10 条互动记录（包含不同的互动类型、状态、类别、创建者）

### 测试用户
- 总监或管理员账户（可以查看所有数据）

---

## 测试用例 1: 多条件组合筛选（AND 逻辑）

### TC1.1: 互动类型 + 状态组合筛选

**测试步骤：**
1. 登录系统（总监/管理员）
2. 导航到全局搜索页面 (`/search`)
3. 切换到"互动"搜索类型
4. 选择多个互动类型（例如："产品询价"、"报价"）
5. 选择多个状态（例如："进行中"、"已完成"）
6. 点击搜索

**预期结果：**
- 系统只显示同时满足以下条件的互动记录：
  - 互动类型为"产品询价"或"报价"
  - 状态为"进行中"或"已完成"
- 搜索结果数量正确
- 所有显示的记录都符合筛选条件

**验证点：**
- [ ] 筛选条件正确应用（AND 逻辑）
- [ ] 搜索结果只包含符合条件的记录
- [ ] 结果数量正确

---

### TC1.2: 产品类别 + 创建者组合筛选

**测试步骤：**
1. 在全局搜索页面
2. 选择多个产品类别（例如："不锈钢"、"塑料"）
3. 选择一个创建者
4. 点击搜索

**预期结果：**
- 系统只显示同时满足以下条件的互动记录：
  - 关联的产品类别为"不锈钢"或"塑料"
  - 创建者为选定的用户
- 搜索结果正确

**验证点：**
- [ ] 产品类别筛选正确应用
- [ ] 创建者筛选正确应用
- [ ] 组合筛选结果正确

---

### TC1.3: 客户类型 + 互动类型 + 时间范围组合筛选

**测试步骤：**
1. 在全局搜索页面（仅总监/管理员可见客户类型筛选）
2. 选择客户类型（例如："采购商"）
3. 选择多个互动类型
4. 选择时间范围（例如：最近 30 天）
5. 点击搜索

**预期结果：**
- 系统只显示同时满足以下条件的互动记录：
  - 客户类型为"采购商"
  - 互动类型在选定范围内
  - 互动时间在选定时间范围内
- 搜索结果正确

**验证点：**
- [ ] 客户类型筛选正确应用
- [ ] 时间范围筛选正确应用
- [ ] 多条件组合筛选结果正确

---

### TC1.4: 完整组合筛选（所有筛选条件）

**测试步骤：**
1. 在全局搜索页面
2. 选择多个互动类型
3. 选择多个状态
4. 选择多个产品类别
5. 选择一个创建者
6. 选择客户类型（如果可见）
7. 选择时间范围
8. 点击搜索

**预期结果：**
- 系统只显示同时满足所有条件的互动记录
- 搜索结果正确
- 筛选条件在 URL 中正确同步

**验证点：**
- [ ] 所有筛选条件正确应用
- [ ] URL 参数正确同步
- [ ] 搜索结果正确

---

## 测试用例 2: 筛选清除功能

### TC2.1: 单个筛选条件清除

**测试步骤：**
1. 在全局搜索页面应用多个筛选条件
2. 在"筛选条件摘要"区域，点击某个筛选条件的"清除"按钮（X）
3. 观察搜索结果更新

**预期结果：**
- 被清除的筛选条件从筛选条件摘要中移除
- 搜索结果自动更新（不再应用该筛选条件）
- URL 参数同步更新

**验证点：**
- [ ] 单个筛选条件可以正确清除
- [ ] 搜索结果正确更新
- [ ] URL 参数正确更新

---

### TC2.2: 全部筛选条件清除

**测试步骤：**
1. 在全局搜索页面应用多个筛选条件
2. 点击"清除所有条件"按钮
3. 观察搜索结果更新

**预期结果：**
- 所有筛选条件被清除
- 筛选条件摘要区域消失或显示"无筛选条件"
- 搜索结果恢复为未筛选状态
- URL 参数中筛选相关参数被清除

**验证点：**
- [ ] 所有筛选条件可以正确清除
- [ ] 搜索结果恢复为未筛选状态
- [ ] URL 参数正确更新

---

### TC2.3: 清除后重新应用筛选

**测试步骤：**
1. 应用多个筛选条件
2. 清除所有筛选条件
3. 重新应用筛选条件
4. 观察搜索结果

**预期结果：**
- 清除后可以重新应用筛选条件
- 重新应用后搜索结果正确
- 筛选状态正确恢复

**验证点：**
- [ ] 清除后可以重新应用筛选
- [ ] 重新应用后结果正确

---

## 测试用例 3: URL 参数同步

### TC3.1: 筛选条件 URL 同步

**测试步骤：**
1. 在全局搜索页面应用多个筛选条件
2. 检查浏览器地址栏的 URL 参数
3. 刷新页面
4. 观察筛选条件是否恢复

**预期结果：**
- URL 参数正确包含所有筛选条件：
  - `interactionTypes=type1,type2`
  - `statuses=status1,status2`
  - `categories=cat1,cat2`
  - `createdBy=userId`
  - `customerType=BUYER`
  - `startDate=YYYY-MM-DD`
  - `endDate=YYYY-MM-DD`
- 刷新页面后筛选条件正确恢复

**验证点：**
- [ ] URL 参数格式正确
- [ ] 多选参数使用逗号分隔
- [ ] 刷新后筛选条件正确恢复

---

## 测试结果记录

### 测试执行日期
- 日期：_____________
- 测试人员：_____________
- 测试环境：_____________

### 测试结果

| 测试用例 | 状态 | 备注 |
|---------|------|------|
| TC1.1: 互动类型 + 状态组合筛选 | ⬜ 通过 / ⬜ 失败 | |
| TC1.2: 产品类别 + 创建者组合筛选 | ⬜ 通过 / ⬜ 失败 | |
| TC1.3: 客户类型 + 互动类型 + 时间范围组合筛选 | ⬜ 通过 / ⬜ 失败 | |
| TC1.4: 完整组合筛选 | ⬜ 通过 / ⬜ 失败 | |
| TC2.1: 单个筛选条件清除 | ⬜ 通过 / ⬜ 失败 | |
| TC2.2: 全部筛选条件清除 | ⬜ 通过 / ⬜ 失败 | |
| TC2.3: 清除后重新应用筛选 | ⬜ 通过 / ⬜ 失败 | |
| TC3.1: 筛选条件 URL 同步 | ⬜ 通过 / ⬜ 失败 | |

### 发现的问题

1. **问题描述：**
   - **严重程度：** ⬜ 高 / ⬜ 中 / ⬜ 低
   - **复现步骤：**
   - **预期结果：**
   - **实际结果：**
   - **截图/日志：**

---

## 测试结论

- [ ] 所有关键测试用例通过
- [ ] 发现的问题已修复
- [ ] Story 6-7 可以标记为 `done`

**测试签名：**
- 测试人员：_____________
- 日期：_____________

